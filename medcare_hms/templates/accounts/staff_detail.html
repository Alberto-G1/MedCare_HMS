{% extends 'base_admin.html' %}

{% block content %}
<style>
    .staff-detail-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .profile-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 10px 10px 0 0;
        display: flex;
        align-items: center;
        gap: 30px;
    }
    
    .profile-picture {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid white;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .profile-info h2 {
        margin: 0 0 10px 0;
        font-size: 28px;
    }
    
    .profile-info .role-badge {
        display: inline-block;
        padding: 5px 15px;
        background: rgba(255,255,255,0.2);
        border-radius: 20px;
        font-size: 14px;
        margin-right: 10px;
    }
    
    .status-badge {
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 14px;
    }
    
    .status-active {
        background: #10b981;
    }
    
    .status-inactive {
        background: #ef4444;
    }
    
    .info-section {
        background: white;
        padding: 25px;
        margin-bottom: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .info-section h3 {
        color: #667eea;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #e5e7eb;
        font-size: 20px;
    }
    
    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }
    
    .info-item {
        padding: 15px;
        background: #f9fafb;
        border-radius: 8px;
        border-left: 3px solid #667eea;
    }
    
    .info-item label {
        display: block;
        color: #6b7280;
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        margin-bottom: 5px;
    }
    
    .info-item .value {
        color: #1f2937;
        font-size: 16px;
        font-weight: 500;
    }
    
    .info-item .value.empty {
        color: #9ca3af;
        font-style: italic;
    }
    
    .action-buttons {
        display: flex;
        gap: 10px;
        padding: 20px;
        background: white;
        border-radius: 0 0 10px 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .availability-list {
        list-style: none;
        padding: 0;
    }
    
    .availability-list li {
        padding: 10px;
        background: #f3f4f6;
        margin-bottom: 8px;
        border-radius: 5px;
        display: flex;
        justify-content: space-between;
    }
    
    .day-name {
        font-weight: 600;
        color: #374151;
    }
    
    .time-range {
        color: #6b7280;
    }
</style>

<div class="staff-detail-container">
    <!-- Profile Header -->
    <div class="profile-header">
        <div>
            {% if staff_member.userprofile.role == 'DOCTOR' and staff_member.doctorprofile.profile_picture %}
                <img src="{{ staff_member.doctorprofile.profile_picture.url }}" alt="{{ staff_member.username }}" class="profile-picture">
            {% elif staff_member.userprofile.role == 'RECEPTIONIST' and staff_member.receptionistprofile.profile_picture %}
                <img src="{{ staff_member.receptionistprofile.profile_picture.url }}" alt="{{ staff_member.username }}" class="profile-picture">
            {% else %}
                <img src="{{ MEDIA_URL }}profile_pictures/default.jpeg" alt="Default" class="profile-picture">
            {% endif %}
        </div>
        <div class="profile-info">
            <h2>{{ staff_member.get_full_name|default:staff_member.username }}</h2>
            <div>
                <span class="role-badge">{{ staff_member.userprofile.get_role_display }}</span>
                {% if staff_member.is_active %}
                    <span class="status-badge status-active">Active</span>
                {% else %}
                    <span class="status-badge status-inactive">Inactive</span>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Basic Information -->
    <div class="info-section">
        <h3><i class="fas fa-user"></i> Basic Information</h3>
        <div class="info-grid">
            <div class="info-item">
                <label>Username</label>
                <div class="value">{{ staff_member.username }}</div>
            </div>
            <div class="info-item">
                <label>First Name</label>
                <div class="value {% if not staff_member.first_name %}empty{% endif %}">
                    {{ staff_member.first_name|default:"Not set" }}
                </div>
            </div>
            <div class="info-item">
                <label>Last Name</label>
                <div class="value {% if not staff_member.last_name %}empty{% endif %}">
                    {{ staff_member.last_name|default:"Not set" }}
                </div>
            </div>
            <div class="info-item">
                <label>Email Address</label>
                <div class="value {% if not staff_member.email %}empty{% endif %}">
                    {{ staff_member.email|default:"Not set" }}
                </div>
            </div>
            <div class="info-item">
                <label>Contact Number</label>
                <div class="value {% if not staff_member.userprofile.contact %}empty{% endif %}">
                    {{ staff_member.userprofile.contact|default:"Not set" }}
                </div>
            </div>
            <div class="info-item">
                <label>Role</label>
                <div class="value">{{ staff_member.userprofile.get_role_display }}</div>
            </div>
        </div>
    </div>
    
    <!-- Account Information -->
    <div class="info-section">
        <h3><i class="fas fa-info-circle"></i> Account Information</h3>
        <div class="info-grid">
            <div class="info-item">
                <label>Date Joined</label>
                <div class="value">{{ staff_member.date_joined|date:"F d, Y - h:i A" }}</div>
            </div>
            <div class="info-item">
                <label>Last Login</label>
                <div class="value {% if not staff_member.last_login %}empty{% endif %}">
                    {{ staff_member.last_login|date:"F d, Y - h:i A"|default:"Never logged in" }}
                </div>
            </div>
            <div class="info-item">
                <label>Account Status</label>
                <div class="value">
                    {% if staff_member.is_active %}
                        <span style="color: #10b981;">✓ Active</span>
                    {% else %}
                        <span style="color: #ef4444;">✗ Inactive</span>
                    {% endif %}
                </div>
            </div>
            <div class="info-item">
                <label>Staff Status</label>
                <div class="value">
                    {% if staff_member.is_staff %}
                        <span style="color: #10b981;">✓ Staff Member</span>
                    {% else %}
                        <span style="color: #6b7280;">Not Staff</span>
                    {% endif %}
                </div>
            </div>
            <div class="info-item">
                <label>Superuser Status</label>
                <div class="value">
                    {% if staff_member.is_superuser %}
                        <span style="color: #f59e0b;">⚠ Superuser</span>
                    {% else %}
                        <span style="color: #6b7280;">Not Superuser</span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Role-Specific Information for Doctors -->
    {% if staff_member.userprofile.role == 'DOCTOR' %}
        <div class="info-section">
            <h3><i class="fas fa-user-md"></i> Doctor-Specific Information</h3>
            <div class="info-grid">
                <div class="info-item">
                    <label>Specialization</label>
                    <div class="value {% if not staff_member.doctorprofile.specialization %}empty{% endif %}">
                        {{ staff_member.doctorprofile.specialization|default:"Not set" }}
                    </div>
                </div>
                <div class="info-item">
                    <label>Department</label>
                    <div class="value {% if not staff_member.doctorprofile.department %}empty{% endif %}">
                        {{ staff_member.doctorprofile.department|default:"Not assigned" }}
                    </div>
                </div>
                <div class="info-item">
                    <label>License Number</label>
                    <div class="value {% if not staff_member.doctorprofile.license_number %}empty{% endif %}">
                        {{ staff_member.doctorprofile.license_number|default:"Not set" }}
                    </div>
                </div>
                <div class="info-item">
                    <label>Years of Experience</label>
                    <div class="value">
                        {{ staff_member.doctorprofile.years_of_experience }} years
                    </div>
                </div>
                <div class="info-item" style="grid-column: 1 / -1;">
                    <label>Availability Notes</label>
                    <div class="value {% if not staff_member.doctorprofile.availability %}empty{% endif %}">
                        {{ staff_member.doctorprofile.availability|default:"Not specified" }}
                    </div>
                </div>
            </div>
            
            <!-- Availability Slots -->
            {% if staff_member.doctorprofile.availability_slots.all %}
                <div style="margin-top: 20px;">
                    <label style="display: block; color: #6b7280; font-size: 13px; font-weight: 600; text-transform: uppercase; margin-bottom: 10px;">
                        Weekly Schedule
                    </label>
                    <ul class="availability-list">
                        {% for slot in staff_member.doctorprofile.availability_slots.all %}
                            <li>
                                <span class="day-name">{{ slot.get_day_of_week_display }}</span>
                                <span class="time-range">{{ slot.start_time|time:"h:i A" }} - {{ slot.end_time|time:"h:i A" }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
    {% endif %}
    
    <!-- Role-Specific Information for Receptionists -->
    {% if staff_member.userprofile.role == 'RECEPTIONIST' %}
        <div class="info-section">
            <h3><i class="fas fa-user-tie"></i> Receptionist-Specific Information</h3>
            <div class="info-grid">
                <div class="info-item">
                    <label>Department</label>
                    <div class="value {% if not staff_member.receptionistprofile.department %}empty{% endif %}">
                        {{ staff_member.receptionistprofile.department|default:"Not assigned" }}
                    </div>
                </div>
                <div class="info-item">
                    <label>Shift</label>
                    <div class="value {% if not staff_member.receptionistprofile.shift %}empty{% endif %}">
                        {{ staff_member.receptionistprofile.get_shift_display|default:"Not assigned" }}
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
    
    <!-- Action Buttons -->
    <div class="action-buttons">
        <a href="{% url 'accounts:staff_management_list' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Staff List
        </a>
        <a href="{% url 'accounts:staff_update' staff_member.pk %}" class="btn btn-primary">
            <i class="fas fa-edit"></i> Update Details
        </a>
        {% if staff_member.is_active %}
            <a href="{% url 'accounts:toggle_staff_status' staff_member.pk %}" class="btn btn-warning" 
               onclick="return confirm('Are you sure you want to deactivate this staff member?')">
                <i class="fas fa-user-slash"></i> Deactivate
            </a>
        {% else %}
            <a href="{% url 'accounts:toggle_staff_status' staff_member.pk %}" class="btn btn-success"
               onclick="return confirm('Are you sure you want to activate this staff member?')">
                <i class="fas fa-user-check"></i> Activate
            </a>
        {% endif %}
    </div>
</div>
{% endblock %}